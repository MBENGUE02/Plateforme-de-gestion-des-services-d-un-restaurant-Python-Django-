{% extends 'composants/adminbase.html' %}
{% block content %}
<div class="container py-4">
  <h2 class="mb-3"> D√©tail de la commande <strong>#{{ commande.id }}</strong></h2>

  <div class="card mb-4">
    <div class="card-body">
      <p><i class="bi bi-person-fill"></i> <strong>Client :</strong> {{ commande.utilisateur.nom }}</p>
      <p><i class="bi bi-calendar-event-fill"></i> <strong>Date :</strong> {{ commande.date_commande|date:"d/m/Y H:i" }}</p>
      <p><i class="bi bi-currency-exchange"></i> <strong>Total :</strong> <span class="text-success">{{ commande.montant_total }} FCFA</span></p>

      <form method="post" class="row g-2 align-items-center mt-3">
        {% csrf_token %}
        <div class="col-auto">
          <label for="statut" class="col-form-label">üßæ Modifier le statut :</label>
        </div>
        <div class="col-auto">
          <select name="statut" id="statut" class="form-select">
            {% for s in statuts %}
              <option value="{{ s.id }}" {% if commande.statut.id == s.id %}selected{% endif %}>
                {{ s.libelle }}
              </option>
            {% endfor %}
          </select>
        </div>
        <div class="col-auto">
          <button type="submit" class="btn btn-success">
            <i class="bi bi-save"></i> Enregistrer
          </button>
        </div>
      </form>
    </div>
  </div>

  <h4 class="mb-3"> Plats command√©s</h4>
  <table class="table table-bordered table-hover">
    <thead class="table-light">
      <tr>
        <th>Plat</th>
        <th>Quantit√©</th>
        <th>Prix unitaire</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody>
      {% for ligne in lignes %}
      <tr>
        <td>{{ ligne.plat.libelle }}</td>
        <td>{{ ligne.quantite }}</td>
        <td>{{ ligne.prix_unitaire }} FCFA</td>
        <td>{{ ligne.total_ligne }} FCFA</td>
      </tr>
      {% empty %}
      <tr><td colspan="4" class="text-center text-muted">Aucun plat dans cette commande.</td></tr>
      {% endfor %}
    </tbody>
  </table>

  <a href="{% url 'gestion_commandes' %}" class="btn btn-secondary mt-3">
    <i class="bi bi-arrow-left"></i> Retour √† la liste
  </a>
</div>
{% endblock %}
